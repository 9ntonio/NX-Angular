<div class="p-4 max-w-4xl mx-auto">
    <!-- Back button -->
    <div class="mb-4">
        <button color="primary" mat-button routerLink="/home">
            <mat-icon>arrow_back</mat-icon>
            Back to Users
        </button>
    </div>

    <!-- Loading State -->
    @if (loading$ | async) {
        <div class="loading-container">
            <mat-spinner diameter="40" />
        </div>
    }

    <!-- Error State -->
    @if (error$ | async; as error) {
        <div class="error-container">
            <mat-icon class="text-red-600">error</mat-icon>
            <p class="error-message">{{ error }}</p>
            <p class="mt-2">The requested user could not be found.</p>
            <button class="mt-4" color="primary" mat-raised-button routerLink="/home">Return to Home</button>
        </div>
    }

    <!-- User Data -->
    @if (selectedUser$ | async; as user) {
        @if ((error$ | async) === null) {
            <mat-card>
                <mat-card-header class="flex justify-between items-start">
                    <div>
                        <mat-card-title class="text-2xl">{{ user.name }}</mat-card-title>
                        <mat-card-subtitle>{{ user.username }}</mat-card-subtitle>
                    </div>
                    <button (click)="toggleFavorite(user.id)" color="warn" mat-icon-button>
                        <mat-icon>{{ user.isFavorite ? 'favorite' : 'favorite_border' }}</mat-icon>
                    </button>
                </mat-card-header>

                <mat-card-content class="mt-6">
                    <!-- Contact Information -->
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4">Contact Information</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <p><strong>Email:</strong> {{ user.email }}</p>
                                <p><strong>Phone:</strong> {{ user.phone }}</p>
                                <p><strong>Website:</strong> {{ user.website }}</p>
                            </div>
                        </div>
                    </div>

                    <mat-divider class="my-6" />

                    <!-- Address -->
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-4">Address</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <p><strong>Street:</strong> {{ user.address.street }}</p>
                                <p><strong>Suite:</strong> {{ user.address.suite }}</p>
                                <p><strong>City:</strong> {{ user.address.city }}</p>
                                <p><strong>Zipcode:</strong> {{ user.address.zipcode }}</p>
                            </div>
                            <div>
                                <p><strong>Geo Location:</strong></p>
                                <p>Lat: {{ user.address.geo.lat }}</p>
                                <p>Lng: {{ user.address.geo.lng }}</p>
                            </div>
                        </div>
                    </div>

                    <mat-divider class="my-6" />

                    <!-- Company Information -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4">Company Details</h3>
                        <div>
                            <p><strong>Company Name:</strong> {{ user.company.name }}</p>
                            <p><strong>Catch Phrase:</strong> {{ user.company.catchPhrase }}</p>
                            <p><strong>BS:</strong> {{ user.company.bs }}</p>
                        </div>
                    </div>
                </mat-card-content>
            </mat-card>
        }
    }
</div>
